{% extends 'base/main.html' %}

{% block content %}
<div id="selector">
<div id="position">Lat: <span id="lat"></span>; Long: <span id="long"></span></div>
</div>
<div id="map">
</div>
{% endblock %}

{% block custom_scripts %}
<script src="/static/js/raycasting.js"></script>
<script type="text/javascript">
/* var po = org.polymaps;

var map = po.map()
    .container(document.getElementById("map").appendChild(po.svg("svg")))
    .add(po.interact())
    .add(po.hash())
    .zoomRange([12,16])
    .center({lat: 37.76, lon: -122.44})
    .zoom(13);

map.add(po.image()
        .url(po.url("http://{S}tile.cloudmade.com"
               + "/b60fbbd51f17456794d2b0e4ed4f0d0c"
              + "/39534/256/{Z}/{X}/{Y}.png")
         .hosts(["a.", "b.", "c.", ""])));

/*map.add(po.image()
    .url(po.url("http://open311-tiles.s3-website-us-east-1.amazonaws.com"
    +"/density/{Z}/{X}/{Y}.png"))); */

/* map.add(po.image()
    .url(po.url("/static/tiles/{Z}/{X}/{Y}.png")));

map.add(po.geoJson()
    .url("/static/sf.json")
    .id("neighborhoods"));

map.add(po.geoJson()
    .url("/static/test.json")
    .id("hotspots")
    .on("load", loadResponseTimes));



map.add(po.compass()
    .pan("none"));

function loadResponseTimes(e) {
  for (var i = 0; i < e.features.length; i++) {
    var feature = e.features[i],
        average = feature.data.properties.average;
    feature.element.setAttribute("stroke-width", 2);
    feature.element.setAttribute("fill", "none");
    if (average > 480) {
      feature.element.setAttribute("stroke", "rgb(21,52,63)");
    } else if (average > 384) {
      feature.element.setAttribute("stroke", "rgb(35,103,127)");
    } else if (average > 288) {
      feature.element.setAttribute("stroke", "rgb(48,154,188)");
    } else if (average > 192) {
      feature.element.setAttribute("stroke", "rgb(123,190,215)");
    } else {
      feature.element.setAttribute("stroke", "rgb(158,205,227)");
    }
  }
}

document.getElementById("map").onmousemove = function(e) {
    var loc = map.pointLocation(map.mouse(e));
    document.getElementById("lat").innerHTML = loc.lat;
    document.getElementById("long").innerHTML = loc.lon;
}; */
</script>
{% endblock %}
